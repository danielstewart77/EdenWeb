<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Eden</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/nav.css">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.8/angular-material.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-animate.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-aria.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-messages.min.js"></script>
    <!-- Angular Material Library -->
    <script src="https://ajax.googleapis.com/ajax/libs/angular_material/1.1.8/angular-material.min.js"></script>  
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!--for the google charts-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
      google.charts.load("current", { packages: ['corechart', 'bar', 'line', 'gauge'] });
      google.charts.setOnLoadCallback(drawCharts);

      function drawCharts(){
          var promise = $.getJSON("https://edengreen.ddns.net/moisture");
          promise.done(function(reading) {
            for (var i = 0; i < 4; i++){
              drawGauge('channel' + i, 'channel' + i, promise['channel' + i]);
            }
          }).fail(function(err){
            // send error to api
          });
        }

        function drawGauge(DivId, Label, Value) {

          var data = google.visualization.arrayToDataTable([
              ["Label", "Value"],
              [Label, Value]
          ]);

          var view = new google.visualization.DataView(data);

          var options = {
                  redFrom: 0, redTo: 3.5,
                  greenFrom: 3.5, greenTo: 6.5,
                  yellowFrom: 6.5, yellowTo: 10,
                  yellowColor: '#0000FF',
                  min: 0,
                  max: 10
              };

          var chart = new google.visualization.Gauge(document.getElementById(DivId));
          chart.draw(view, options);
        }
    </script>
    <!-- <script type="text/javascript" src="controls/gauge1.js"></script> -->

        <!-- Load c3.css -->
        <!-- <link href="c3/c3.css" rel="stylesheet"> -->

        <!-- Load d3.js and c3.js -->
        <!-- <script src="https://d3js.org/d3.v5.js"></script>
        <script src="c3/c3.min.js"></script> -->

        <!-- <script src="controls/gauge.js"></script> -->
    
    
</head>
<body ng-app="eden" ng-controller="edenCtl" style="background-color: black">
  <!-- <div ng-include="'/login.html'" ng-if="!enterprise"></div>
  <div ng-if="enterprise"> -->
  
    <md-toolbar class="dimGrey" >
        <div class="md-toolbar-tools dimGrey" style="height:80px">
          <md-button class="btn1" ng-click="showMenu('true')">
            Menu
              <md-icon md-svg-icon="img/gear.svg"></md-icon>
          </md-button>
  
          <h2 flex md-truncate>Eden Greenhouse Monitor v0.1</h2>
          <!-- <md-button class="btn2" ng-click="signOut()">
            Sign Out
          </md-button> -->
        </div>
      </md-toolbar>

    <section layout="row" flex md-theme="customTheme">

        <md-sidenav class="md-sidenav-left" 
          md-is-locked-open="menuVisible"
          md-disable-backdrop md-whiteframe="4">
    
          <md-toolbar class="md-primary">
            <div class="md-toolbar-tools">
              <h1 class="md-flex">Menu</h1>
            </div>
          </md-toolbar>
    
          <md-content layout="column">
            <p>
              <input type="button" value="Config" ng-click="show('config')" class="btn2" />
              <input type="button" value="Dashboard" ng-click="show('dashboard')" class="btn2" />
            </p>

            <md-button ng-click="showMenu(false)" class="btn2">
              Close Menu
            </md-button>
          </md-content>
    
        </md-sidenav>
  </section>

  <div ng-if="template" ng-include="template + '.html'" flex></div>
      
  </div>
  <script>
    angular.module('eden', ['ngMaterial']).controller('edenCtl', function ($scope) {
        
        $scope.menuVisible = false;
        $scope.template = 'dashboard';

        

        

        $scope.showMenu = () => {
            //toggle
            if ($scope.menuVisible == true){
                $scope.menuVisible = false;
            }
            else{
                $scope.menuVisible = true;
            }
        };

        $scope.show = (template) => {
            if (template){
                //pouchdb.find(type, $scope);
                $scope.template = template;
                $scope.menuVisible = false;
            }

            
        };

        if ($scope.template == 'dashboard'){
                drawCharts();
            }

        

    }).config(function ($mdThemingProvider) {
        $mdThemingProvider.theme('customTheme')
            .primaryPalette('grey')
            .accentPalette('orange')
            .warnPalette('red');
    });
</script>
</body>
</html>